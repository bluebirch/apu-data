---
title: "Replikering av Testdata från APU"
author: "Stefan Björk"
output:
  pdf_document:
    number_sections: true
    latex_engine: xelatex
  html_document: default
mainfont: "Minion Pro"
fontsize: 12pt
lang: sv-SE
papersize: a4
---

```{r setup, include=FALSE}
library(knitr)
knitr::opts_chunk$set(echo = TRUE)
options(knitr.kable.NA = '')

# Läs in CSV-filen (som är fixad med perlscriptet)
af <- read.csv2("WTS+ATS.csv", encoding="UTF-8")

# Ändra benämning på utbildningsnivå
levels(af$Utbildningsnivå) <- c("Okänd","EU1", "EU2", "EU3", "EU4", "EU5")

```

# Inledning

Detta är ett försök att replikera siffrorna i *Testdata från APU på Arbetsförmedlingen 2012--2016* av Marcus Lindskog, Nicklas Timstedt och Maria Öhrstedt.

# Deskriptiva data

## Totalt antal individer

I datafilen finns `r nrow(af)` poster (individer), men *Testdata från APU* uppger att det skall vara 5680 individer; här saknas alltså `r 5680-nrow(af)` individer. Eftersom datafilen är sammanslagen med resultat från två system (WTS och ATS) förmodar jag att det rör sig om de indivder som råkar finnas båda. Tagna separat kan det röra sig om fler indivder; detta måste undersökas.

## Könsfördelning

Könsfödelningen i *Testdata från APU* är "ca 42% kvinnor och 58% män".

```{r echo=FALSE, results='asis'}
library(plyr)
t <- count(af,vars="Kön")
t$rfreq <- round(t$freq/sum(t$freq)*100, digits=1)
kable(t, caption="Könsfördelning", col.names=c("Kön","n", "%"))
```

Könsfördelningen i datafilen motsvarar alltså dokumentet, men jag har inte tillgång till frekvens, bara relativ frekvens.

## Utbildningsnivå

```{r echo=FALSE, results='asis'}
t0 <- data.frame(Utbildningsnivå=c("Okänd","EU1","EU2","EU3","EU4","EU5"),freq=c(797,350,1516,2300,518,199))
t0$rfreq <- round(t0$freq/sum(t0$freq)*100, digits=1)
t0$rfreq2 <- round(t0$freq/(sum(t0$freq)-t0$freq[1])*100, digits=1)
t0$rfreq2[1] <- NA
kable(t0, caption="Utbildningsnivå i Testdata från APU.", col.names=c("Utbildningsnivå","n", "%", "Korr. %"))
```

```{r echo=FALSE, results='asis'}
t1 <- count(af, vars="Utbildningsnivå")
t1$rfreq <- round(t1$freq/sum(t1$freq)*100, digits=1)
t1$rfreq2 <- round(t1$freq/(sum(t1$freq)-t1$freq[1])*100, digits=1)
t1$rfreq2[1] <- NA
kable(t1, caption="Utbildningsnivå i datafil", col.names=c("Utbildningsnivå","n", "%", "Korr. %"))
```

Som synes är det en stor skillnad vad gäller andelen okända; det är många fler i *Testdata från APU*. Sett till de som är kända är fördelningen dock ganska lika (jämför kolumnen *Korr. %*); se också stapeldiagram nedan.

```{r echo=FALSE, fig.cap="Utbildningsnivå i Testdata från APU respektive datafil."}
t <- rbind(t0$rfreq2[2:6],t1$rfreq2[2:6])
rownames(t) <- c("Testdata från APU", "Datafil")
colnames(t) <- t0$Utbildningsnivå[2:6]
barplot(t, xlab="Utbildningsnivå", col=c("darkblue","red"), legend = rownames(t), beside=TRUE)
```

Återstår här:

* Bryta ner utbildningsnivå på ålder.
* Bryta ner utbildningsnivå på kön.
